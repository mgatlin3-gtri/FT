2022-07-07 10:20:47.859409: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2022-07-07 10:20:47.859667: W tensorflow/stream_executor/platform/default/dso_loader.cc:60] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory
2022-07-07 10:20:47.859696: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-07-07 10:20:47.859726: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (ice-login1.icehammer.gtri.org): /proc/driver/nvidia/version does not exist
2022-07-07 10:20:47.859987: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-07-07 10:20:47.860265: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
[34m[1mwandb[39m[22m: [33mWARNING[39m The save_model argument by default saves the model in the HDF5 format that cannot save custom objects like subclassed models and custom layers. This behavior will be deprecated in a future release in favor of the SavedModel format. Meanwhile, the HDF5 model is saved as W&B files and the SavedModel as W&B Artifacts.
2022-07-07 10:20:48.056074: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2022-07-07 10:20:48.056521: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 3499755000 Hz
Traceback (most recent call last):
  File "/home/apopa6/feces_thesis/2dCNN3.py", line 105, in <module>
    model.fit(train_generator, validation_data=val_generator, epochs=wandb.config.epochs, batch_size=wandb.config.batch_size,
  File "/home/apopa6/.conda/envs/ICE_NN/lib/python3.9/site-packages/wandb/integration/keras/keras.py", line 163, in new_v2
    return old_v2(*args, **kwargs)
  File "/home/apopa6/.conda/envs/ICE_NN/lib/python3.9/site-packages/tensorflow/python/keras/engine/training.py", line 1100, in fit
    tmp_logs = self.train_function(iterator)
  File "/home/apopa6/.conda/envs/ICE_NN/lib/python3.9/site-packages/tensorflow/python/eager/def_function.py", line 828, in __call__
    result = self._call(*args, **kwds)
  File "/home/apopa6/.conda/envs/ICE_NN/lib/python3.9/site-packages/tensorflow/python/eager/def_function.py", line 888, in _call
    return self._stateless_fn(*args, **kwds)
  File "/home/apopa6/.conda/envs/ICE_NN/lib/python3.9/site-packages/tensorflow/python/eager/function.py", line 2941, in __call__
    filtered_flat_args) = self._maybe_define_function(args, kwargs)
  File "/home/apopa6/.conda/envs/ICE_NN/lib/python3.9/site-packages/tensorflow/python/eager/function.py", line 3361, in _maybe_define_function
    graph_function = self._create_graph_function(args, kwargs)
  File "/home/apopa6/.conda/envs/ICE_NN/lib/python3.9/site-packages/tensorflow/python/eager/function.py", line 3196, in _create_graph_function
    func_graph_module.func_graph_from_py_func(
  File "/home/apopa6/.conda/envs/ICE_NN/lib/python3.9/site-packages/tensorflow/python/framework/func_graph.py", line 990, in func_graph_from_py_func
    func_outputs = python_func(*func_args, **func_kwargs)
  File "/home/apopa6/.conda/envs/ICE_NN/lib/python3.9/site-packages/tensorflow/python/eager/def_function.py", line 634, in wrapped_fn
    out = weak_wrapped_fn().__wrapped__(*args, **kwds)
  File "/home/apopa6/.conda/envs/ICE_NN/lib/python3.9/site-packages/tensorflow/python/framework/func_graph.py", line 966, in wrapper
    return autograph.converted_call(
  File "/home/apopa6/.conda/envs/ICE_NN/lib/python3.9/site-packages/tensorflow/python/autograph/impl/api.py", line 459, in converted_call
    result = converted_f(*effective_args, **kwargs)
  File "/tmp/tmp4fn_ef3k.py", line 16, in tf__train_function
    retval_ = ag__.converted_call(ag__.ld(step_function), (ag__.ld(self), ag__.ld(iterator)), None, fscope)
  File "/home/apopa6/.conda/envs/ICE_NN/lib/python3.9/site-packages/tensorflow/python/autograph/impl/api.py", line 350, in converted_call
    return _call_unconverted(f, args, kwargs, options, False)
  File "/home/apopa6/.conda/envs/ICE_NN/lib/python3.9/site-packages/tensorflow/python/autograph/impl/api.py", line 479, in _call_unconverted
    return f(*args)
  File "/home/apopa6/.conda/envs/ICE_NN/lib/python3.9/site-packages/tensorflow/python/keras/engine/training.py", line 795, in step_function
    outputs = model.distribute_strategy.run(run_step, args=(data,))
  File "/home/apopa6/.conda/envs/ICE_NN/lib/python3.9/site-packages/tensorflow/python/distribute/distribute_lib.py", line 1259, in run
    return self._extended.call_for_each_replica(fn, args=args, kwargs=kwargs)
  File "/home/apopa6/.conda/envs/ICE_NN/lib/python3.9/site-packages/tensorflow/python/distribute/distribute_lib.py", line 2730, in call_for_each_replica
    return self._call_for_each_replica(fn, args, kwargs)
  File "/home/apopa6/.conda/envs/ICE_NN/lib/python3.9/site-packages/tensorflow/python/distribute/distribute_lib.py", line 3417, in _call_for_each_replica
    return fn(*args, **kwargs)
  File "/home/apopa6/.conda/envs/ICE_NN/lib/python3.9/site-packages/tensorflow/python/autograph/impl/api.py", line 667, in wrapper
    return converted_call(f, args, kwargs, options=options)
  File "/home/apopa6/.conda/envs/ICE_NN/lib/python3.9/site-packages/tensorflow/python/autograph/impl/api.py", line 396, in converted_call
    return _call_unconverted(f, args, kwargs, options)
  File "/home/apopa6/.conda/envs/ICE_NN/lib/python3.9/site-packages/tensorflow/python/autograph/impl/api.py", line 478, in _call_unconverted
    return f(*args, **kwargs)
  File "/home/apopa6/.conda/envs/ICE_NN/lib/python3.9/site-packages/tensorflow/python/keras/engine/training.py", line 788, in run_step
    outputs = model.train_step(data)
  File "/home/apopa6/.conda/envs/ICE_NN/lib/python3.9/site-packages/tensorflow/python/keras/engine/training.py", line 757, in train_step
    self.optimizer.minimize(loss, self.trainable_variables, tape=tape)
  File "/home/apopa6/.conda/envs/ICE_NN/lib/python3.9/site-packages/tensorflow/python/keras/optimizer_v2/optimizer_v2.py", line 498, in minimize
    return self.apply_gradients(grads_and_vars, name=name)
  File "/home/apopa6/.conda/envs/ICE_NN/lib/python3.9/site-packages/tensorflow/python/keras/optimizer_v2/optimizer_v2.py", line 625, in apply_gradients
    apply_state = self._prepare(var_list)
  File "/home/apopa6/.conda/envs/ICE_NN/lib/python3.9/site-packages/tensorflow/python/keras/optimizer_v2/optimizer_v2.py", line 880, in _prepare
    self._prepare_local(var_device, var_dtype, apply_state)
  File "/home/apopa6/.conda/envs/ICE_NN/lib/python3.9/site-packages/tensorflow/python/keras/optimizer_v2/adam.py", line 138, in _prepare_local
    beta_1_t = array_ops.identity(self._get_hyper('beta_1', var_dtype))
  File "/home/apopa6/.conda/envs/ICE_NN/lib/python3.9/site-packages/tensorflow/python/keras/optimizer_v2/optimizer_v2.py", line 761, in _get_hyper
    return math_ops.cast(value, dtype)
  File "/home/apopa6/.conda/envs/ICE_NN/lib/python3.9/site-packages/tensorflow/python/util/dispatch.py", line 201, in wrapper
    return target(*args, **kwargs)
  File "/home/apopa6/.conda/envs/ICE_NN/lib/python3.9/site-packages/tensorflow/python/ops/math_ops.py", line 964, in cast
    x = ops.convert_to_tensor(x, name="x")
  File "/home/apopa6/.conda/envs/ICE_NN/lib/python3.9/site-packages/tensorflow/python/profiler/trace.py", line 163, in wrapped
    return func(*args, **kwargs)
  File "/home/apopa6/.conda/envs/ICE_NN/lib/python3.9/site-packages/tensorflow/python/framework/ops.py", line 1540, in convert_to_tensor
    ret = conversion_func(value, dtype=dtype, name=name, as_ref=as_ref)
  File "/home/apopa6/.conda/envs/ICE_NN/lib/python3.9/site-packages/tensorflow/python/ops/resource_variable_ops.py", line 1992, in _dense_var_to_tensor
    return var._dense_var_to_tensor(dtype=dtype, name=name, as_ref=as_ref)  # pylint: disable=protected-access
  File "/home/apopa6/.conda/envs/ICE_NN/lib/python3.9/site-packages/tensorflow/python/ops/resource_variable_ops.py", line 1393, in _dense_var_to_tensor
    return self.value()
  File "/home/apopa6/.conda/envs/ICE_NN/lib/python3.9/site-packages/tensorflow/python/ops/resource_variable_ops.py", line 565, in value
    return self._read_variable_op()
  File "/home/apopa6/.conda/envs/ICE_NN/lib/python3.9/site-packages/tensorflow/python/ops/resource_variable_ops.py", line 672, in _read_variable_op
    result = read_and_set_handle()
  File "/home/apopa6/.conda/envs/ICE_NN/lib/python3.9/site-packages/tensorflow/python/ops/resource_variable_ops.py", line 662, in read_and_set_handle
    result = gen_resource_variable_ops.read_variable_op(
  File "/home/apopa6/.conda/envs/ICE_NN/lib/python3.9/site-packages/tensorflow/python/ops/gen_resource_variable_ops.py", line 484, in read_variable_op
    _, _, _op, _outputs = _op_def_library._apply_op_helper(
  File "/home/apopa6/.conda/envs/ICE_NN/lib/python3.9/site-packages/tensorflow/python/framework/op_def_library.py", line 517, in _apply_op_helper
    values = ops.convert_to_tensor(
  File "/home/apopa6/.conda/envs/ICE_NN/lib/python3.9/site-packages/tensorflow/python/profiler/trace.py", line 163, in wrapped
    return func(*args, **kwargs)
  File "/home/apopa6/.conda/envs/ICE_NN/lib/python3.9/site-packages/tensorflow/python/framework/ops.py", line 1501, in convert_to_tensor
    return graph.capture(value, name=name)
  File "/home/apopa6/.conda/envs/ICE_NN/lib/python3.9/site-packages/tensorflow/python/framework/func_graph.py", line 626, in capture
    return self._capture_helper(tensor, name, shape)
  File "/home/apopa6/.conda/envs/ICE_NN/lib/python3.9/site-packages/tensorflow/python/framework/func_graph.py", line 646, in _capture_helper
    placeholder = _create_substitute_placeholder(
  File "/home/apopa6/.conda/envs/ICE_NN/lib/python3.9/site-packages/tensorflow/python/framework/func_graph.py", line 1134, in _create_substitute_placeholder
    placeholder = graph_placeholder(
  File "/home/apopa6/.conda/envs/ICE_NN/lib/python3.9/site-packages/tensorflow/python/eager/graph_only_ops.py", line 38, in graph_placeholder
    op = g._create_op_internal(  # pylint: disable=protected-access
  File "/home/apopa6/.conda/envs/ICE_NN/lib/python3.9/site-packages/tensorflow/python/framework/func_graph.py", line 590, in _create_op_internal
    return super(FuncGraph, self)._create_op_internal(  # pylint: disable=protected-access
  File "/home/apopa6/.conda/envs/ICE_NN/lib/python3.9/site-packages/tensorflow/python/framework/ops.py", line 3528, in _create_op_internal
    ret = Operation(
  File "/home/apopa6/.conda/envs/ICE_NN/lib/python3.9/site-packages/tensorflow/python/framework/ops.py", line 2028, in __init__
    tensor = Tensor._create_with_tf_output(self, i, output_type, tf_output)  # pylint: disable=protected-access
  File "/home/apopa6/.conda/envs/ICE_NN/lib/python3.9/site-packages/tensorflow/python/framework/ops.py", line 390, in _create_with_tf_output
    ret = Tensor(op, value_index, dtype)
  File "/home/apopa6/.conda/envs/ICE_NN/lib/python3.9/site-packages/tensorflow/python/framework/ops.py", line 385, in __init__
    self._id = uid()
  File "/home/apopa6/.conda/envs/ICE_NN/lib/python3.9/site-packages/tensorflow/python/framework/ops.py", line 220, in uid
    return pywrap_tfe.TFE_Py_UID()
KeyboardInterrupt
Found 1260 images belonging to 3 classes.
Found 246 images belonging to 3 classes.
Found 318 images belonging to 3 classes.
Model: "sequential"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
conv2d (Conv2D)              (None, 478, 638, 64)      1792
_________________________________________________________________
max_pooling2d (MaxPooling2D) (None, 239, 319, 64)      0
_________________________________________________________________
dropout (Dropout)            (None, 239, 319, 64)      0
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 237, 317, 64)      36928
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 118, 158, 64)      0
_________________________________________________________________
dropout_1 (Dropout)          (None, 118, 158, 64)      0
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 116, 156, 128)     73856
_________________________________________________________________
max_pooling2d_2 (MaxPooling2 (None, 58, 78, 128)       0
_________________________________________________________________
dropout_2 (Dropout)          (None, 58, 78, 128)       0
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 56, 76, 64)        73792
_________________________________________________________________
max_pooling2d_3 (MaxPooling2 (None, 28, 38, 64)        0
_________________________________________________________________
dropout_3 (Dropout)          (None, 28, 38, 64)        0
_________________________________________________________________
global_average_pooling2d (Gl (None, 64)                0
_________________________________________________________________
dropout_4 (Dropout)          (None, 64)                0
_________________________________________________________________
dense (Dense)                (None, 3)                 195
=================================================================
Total params: 186,563
Trainable params: 186,563
Non-trainable params: 0
_________________________________________________________________
Epoch 1/200