2022-06-09 12:51:06.107027: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2022-06-09 12:51:06.107650: W tensorflow/stream_executor/platform/default/dso_loader.cc:60] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory
2022-06-09 12:51:06.107675: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2022-06-09 12:51:06.107705: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (ice-login1.icehammer.gtri.org): /proc/driver/nvidia/version does not exist
2022-06-09 12:51:06.107981: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-06-09 12:51:06.108249: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
[34m[1mwandb[39m[22m: [33mWARNING[39m The save_model argument by default saves the model in the HDF5 format that cannot save custom objects like subclassed models and custom layers. This behavior will be deprecated in a future release in favor of the SavedModel format. Meanwhile, the HDF5 model is saved as W&B files and the SavedModel as W&B Artifacts.
Found 924 images belonging to 4 classes.
Model: "sequential"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
conv2d (Conv2D)              (None, 478, 638, 32)      896
_________________________________________________________________
max_pooling2d (MaxPooling2D) (None, 239, 319, 32)      0
_________________________________________________________________
dropout (Dropout)            (None, 239, 319, 32)      0
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 237, 317, 32)      9248
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 118, 158, 32)      0
_________________________________________________________________
dropout_1 (Dropout)          (None, 118, 158, 32)      0
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 116, 156, 32)      9248
_________________________________________________________________
max_pooling2d_2 (MaxPooling2 (None, 58, 78, 32)        0
_________________________________________________________________
dropout_2 (Dropout)          (None, 58, 78, 32)        0
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 56, 76, 32)        9248
_________________________________________________________________
max_pooling2d_3 (MaxPooling2 (None, 28, 38, 32)        0
_________________________________________________________________
dropout_3 (Dropout)          (None, 28, 38, 32)        0
_________________________________________________________________
flatten (Flatten)            (None, 34048)             0
_________________________________________________________________
dense (Dense)                (None, 64)                2179136
_________________________________________________________________
dense_1 (Dense)              (None, 4)                 260
=================================================================
Total params: 2,208,036
Trainable params: 2,208,036
Non-trainable params: 0
_________________________________________________________________
2022-06-09 12:51:07.835335: W tensorflow/core/framework/cpu_allocator_impl.cc:80] Allocation of 117964800 exceeds 10% of free system memory.
2022-06-09 12:51:07.953226: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2022-06-09 12:51:07.953775: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 3499755000 Hz
2022-06-09 12:51:10.147472: W tensorflow/core/framework/cpu_allocator_impl.cc:80] Allocation of 117964800 exceeds 10% of free system memory.
2022-06-09 12:51:10.211194: W tensorflow/core/framework/cpu_allocator_impl.cc:80] Allocation of 1249132544 exceeds 10% of free system memory.
2022-06-09 12:51:10.696397: W tensorflow/core/framework/cpu_allocator_impl.cc:80] Allocation of 312283136 exceeds 10% of free system memory.
2022-06-09 12:51:10.819594: W tensorflow/core/framework/cpu_allocator_impl.cc:80] Allocation of 312283136 exceeds 10% of free system memory.



 4/29 [===>..........................] - ETA: 2:05 - loss: 1.4769 - accuracy: 0.2036
Traceback (most recent call last):
  File "/home/apopa6/feces_thesis/2dCNN.py", line 61, in <module>
    history = model.fit(train_generator, callbacks=[WandbCallback()])
  File "/home/apopa6/.conda/envs/ICE_NN/lib/python3.9/site-packages/wandb/integration/keras/keras.py", line 163, in new_v2
    return old_v2(*args, **kwargs)
  File "/home/apopa6/.conda/envs/ICE_NN/lib/python3.9/site-packages/tensorflow/python/keras/engine/training.py", line 1100, in fit
    tmp_logs = self.train_function(iterator)
  File "/home/apopa6/.conda/envs/ICE_NN/lib/python3.9/site-packages/tensorflow/python/eager/def_function.py", line 828, in __call__
    result = self._call(*args, **kwds)
  File "/home/apopa6/.conda/envs/ICE_NN/lib/python3.9/site-packages/tensorflow/python/eager/def_function.py", line 855, in _call
    return self._stateless_fn(*args, **kwds)  # pylint: disable=not-callable
  File "/home/apopa6/.conda/envs/ICE_NN/lib/python3.9/site-packages/tensorflow/python/eager/function.py", line 2942, in __call__
    return graph_function._call_flat(
  File "/home/apopa6/.conda/envs/ICE_NN/lib/python3.9/site-packages/tensorflow/python/eager/function.py", line 1918, in _call_flat
    return self._build_call_outputs(self._inference_function.call(
  File "/home/apopa6/.conda/envs/ICE_NN/lib/python3.9/site-packages/tensorflow/python/eager/function.py", line 555, in call
    outputs = execute.execute(
  File "/home/apopa6/.conda/envs/ICE_NN/lib/python3.9/site-packages/tensorflow/python/eager/execute.py", line 59, in quick_execute
    tensors = pywrap_tfe.TFE_Py_Execute(ctx._handle, device_name, op_name,
