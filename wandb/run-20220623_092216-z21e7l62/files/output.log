2022-06-23 09:22:20.921626: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2022-06-23 09:22:20.922586: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2022-06-23 09:22:20.954546: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:5e:00.0 name: NVIDIA GeForce GTX 1080 Ti computeCapability: 6.1
coreClock: 1.582GHz coreCount: 28 deviceMemorySize: 10.92GiB deviceMemoryBandwidth: 451.17GiB/s
2022-06-23 09:22:20.954909: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 1 with properties:
pciBusID: 0000:86:00.0 name: NVIDIA GeForce GTX 1080 Ti computeCapability: 6.1
coreClock: 1.582GHz coreCount: 28 deviceMemorySize: 10.92GiB deviceMemoryBandwidth: 451.17GiB/s
2022-06-23 09:22:20.954926: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2022-06-23 09:22:20.957355: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2022-06-23 09:22:20.957405: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2022-06-23 09:22:20.959526: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2022-06-23 09:22:20.959998: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2022-06-23 09:22:20.962214: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2022-06-23 09:22:20.963460: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2022-06-23 09:22:20.967785: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2022-06-23 09:22:20.968919: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0, 1
2022-06-23 09:22:20.969276: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-06-23 09:22:20.969360: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2022-06-23 09:22:21.138891: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:5e:00.0 name: NVIDIA GeForce GTX 1080 Ti computeCapability: 6.1
coreClock: 1.582GHz coreCount: 28 deviceMemorySize: 10.92GiB deviceMemoryBandwidth: 451.17GiB/s
2022-06-23 09:22:21.139134: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 1 with properties:
pciBusID: 0000:86:00.0 name: NVIDIA GeForce GTX 1080 Ti computeCapability: 6.1
coreClock: 1.582GHz coreCount: 28 deviceMemorySize: 10.92GiB deviceMemoryBandwidth: 451.17GiB/s
2022-06-23 09:22:21.139158: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2022-06-23 09:22:21.139184: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2022-06-23 09:22:21.139198: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2022-06-23 09:22:21.139209: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2022-06-23 09:22:21.139221: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2022-06-23 09:22:21.139232: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2022-06-23 09:22:21.139243: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2022-06-23 09:22:21.139254: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2022-06-23 09:22:21.139965: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0, 1
2022-06-23 09:22:21.139994: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2022-06-23 09:22:21.889507: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2022-06-23 09:22:21.889550: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 1
2022-06-23 09:22:21.889565: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N Y
2022-06-23 09:22:21.889570: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 1:   Y N
2022-06-23 09:22:21.890653: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10245 MB memory) -> physical GPU (device: 0, name: NVIDIA GeForce GTX 1080 Ti, pci bus id: 0000:5e:00.0, compute capability: 6.1)
2022-06-23 09:22:21.891380: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 10255 MB memory) -> physical GPU (device: 1, name: NVIDIA GeForce GTX 1080 Ti, pci bus id: 0000:86:00.0, compute capability: 6.1)
[34m[1mwandb[39m[22m: [33mWARNING[39m The save_model argument by default saves the model in the HDF5 format that cannot save custom objects like subclassed models and custom layers. This behavior will be deprecated in a future release in favor of the SavedModel format. Meanwhile, the HDF5 model is saved as W&B files and the SavedModel as W&B Artifacts.
2022-06-23 09:22:22.120022: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2022-06-23 09:22:22.120458: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2600000000 Hz
2022-06-23 09:22:22.664468: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2022-06-23 09:22:22.860038: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2022-06-23 09:22:23.431205: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2022-06-23 09:22:23.466815: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output:
Relying on driver to perform ptx compilation.
Modify $PATH to customize ptxas location.
This message will be only logged once.
Found 1120 images belonging to 4 classes.
Found 264 images belonging to 4 classes.
Found 220 images belonging to 4 classes.
Model: "sequential"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
conv2d (Conv2D)              (None, 478, 638, 64)      1792
_________________________________________________________________
max_pooling2d (MaxPooling2D) (None, 239, 319, 64)      0
_________________________________________________________________
dropout (Dropout)            (None, 239, 319, 64)      0
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 237, 317, 32)      18464
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 118, 158, 32)      0
_________________________________________________________________
dropout_1 (Dropout)          (None, 118, 158, 32)      0
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 116, 156, 64)      18496
_________________________________________________________________
max_pooling2d_2 (MaxPooling2 (None, 58, 78, 64)        0
_________________________________________________________________
dropout_2 (Dropout)          (None, 58, 78, 64)        0
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 56, 76, 16)        9232
_________________________________________________________________
max_pooling2d_3 (MaxPooling2 (None, 28, 38, 16)        0
_________________________________________________________________
dropout_3 (Dropout)          (None, 28, 38, 16)        0
_________________________________________________________________
global_average_pooling2d (Gl (None, 16)                0
_________________________________________________________________
dropout_4 (Dropout)          (None, 16)                0
_________________________________________________________________
dense (Dense)                (None, 4)                 68
=================================================================
Total params: 48,052
Trainable params: 48,052
Non-trainable params: 0
_________________________________________________________________
Epoch 1/100






280/280 [==============================] - 21s 53ms/step - loss: 1.3901 - accuracy: 0.2552 - val_loss: 1.2469 - val_accuracy: 0.3864
Epoch 2/100






280/280 [==============================] - 15s 52ms/step - loss: 1.2977 - accuracy: 0.3843 - val_loss: 1.1755 - val_accuracy: 0.4924
Epoch 3/100






280/280 [==============================] - 14s 51ms/step - loss: 1.1931 - accuracy: 0.4236 - val_loss: 1.0467 - val_accuracy: 0.5985
Epoch 4/100







280/280 [==============================] - 14s 52ms/step - loss: 1.1462 - accuracy: 0.5017 - val_loss: 0.9595 - val_accuracy: 0.6742
Epoch 5/100





280/280 [==============================] - 15s 52ms/step - loss: 1.0353 - accuracy: 0.5682 - val_loss: 0.9225 - val_accuracy: 0.6591
Epoch 6/100






280/280 [==============================] - 15s 52ms/step - loss: 1.0220 - accuracy: 0.5420 - val_loss: 0.9621 - val_accuracy: 0.6288
Epoch 7/100






280/280 [==============================] - 14s 51ms/step - loss: 0.9555 - accuracy: 0.6272 - val_loss: 0.8244 - val_accuracy: 0.7121
Epoch 8/100






280/280 [==============================] - 14s 51ms/step - loss: 0.9520 - accuracy: 0.5894 - val_loss: 0.8833 - val_accuracy: 0.6591
Epoch 9/100







280/280 [==============================] - 15s 52ms/step - loss: 0.8553 - accuracy: 0.6495 - val_loss: 0.7989 - val_accuracy: 0.6970
Epoch 10/100






280/280 [==============================] - 14s 52ms/step - loss: 0.8892 - accuracy: 0.6398 - val_loss: 0.8257 - val_accuracy: 0.6932
Epoch 11/100






280/280 [==============================] - 14s 51ms/step - loss: 0.8865 - accuracy: 0.6315 - val_loss: 0.7015 - val_accuracy: 0.7159
Epoch 12/100






280/280 [==============================] - 14s 52ms/step - loss: 0.8142 - accuracy: 0.6715 - val_loss: 0.6701 - val_accuracy: 0.7500
Epoch 13/100






280/280 [==============================] - 15s 53ms/step - loss: 0.7401 - accuracy: 0.7122 - val_loss: 0.6854 - val_accuracy: 0.6894
Epoch 14/100






280/280 [==============================] - 15s 52ms/step - loss: 0.7795 - accuracy: 0.7167 - val_loss: 0.5969 - val_accuracy: 0.7424
Epoch 15/100






280/280 [==============================] - 14s 52ms/step - loss: 0.7104 - accuracy: 0.7312 - val_loss: 0.6882 - val_accuracy: 0.6894
Epoch 16/100






280/280 [==============================] - 15s 52ms/step - loss: 0.6937 - accuracy: 0.7234 - val_loss: 0.5734 - val_accuracy: 0.7879
Epoch 17/100






280/280 [==============================] - 15s 52ms/step - loss: 0.6712 - accuracy: 0.7439 - val_loss: 0.5230 - val_accuracy: 0.7955
Epoch 18/100






280/280 [==============================] - 14s 51ms/step - loss: 0.6352 - accuracy: 0.7523 - val_loss: 0.5133 - val_accuracy: 0.8030
Epoch 19/100






280/280 [==============================] - 15s 52ms/step - loss: 0.6471 - accuracy: 0.7615 - val_loss: 0.5086 - val_accuracy: 0.7955
Epoch 20/100






280/280 [==============================] - 14s 51ms/step - loss: 0.6291 - accuracy: 0.7519 - val_loss: 0.5022 - val_accuracy: 0.7992
Epoch 21/100






280/280 [==============================] - 14s 51ms/step - loss: 0.6480 - accuracy: 0.7527 - val_loss: 0.4941 - val_accuracy: 0.7803
Epoch 22/100






280/280 [==============================] - 14s 51ms/step - loss: 0.6152 - accuracy: 0.7647 - val_loss: 0.5133 - val_accuracy: 0.7917
Epoch 23/100






280/280 [==============================] - 14s 52ms/step - loss: 0.5658 - accuracy: 0.7661 - val_loss: 0.4979 - val_accuracy: 0.7917
Epoch 24/100






280/280 [==============================] - 14s 52ms/step - loss: 0.6053 - accuracy: 0.7568 - val_loss: 0.4133 - val_accuracy: 0.8371
Epoch 25/100






280/280 [==============================] - 15s 52ms/step - loss: 0.6235 - accuracy: 0.7628 - val_loss: 0.4637 - val_accuracy: 0.8068
Epoch 26/100






280/280 [==============================] - 15s 52ms/step - loss: 0.5749 - accuracy: 0.7812 - val_loss: 0.6389 - val_accuracy: 0.6856
Epoch 27/100






280/280 [==============================] - 15s 52ms/step - loss: 0.5358 - accuracy: 0.7887 - val_loss: 0.4600 - val_accuracy: 0.8030
Epoch 28/100






280/280 [==============================] - 14s 51ms/step - loss: 0.5386 - accuracy: 0.7944 - val_loss: 0.4482 - val_accuracy: 0.8144
Epoch 29/100







