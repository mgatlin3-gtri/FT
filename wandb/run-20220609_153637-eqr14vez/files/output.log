
Found 924 images belonging to 4 classes.
2022-06-09 15:36:43.496610: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2022-06-09 15:36:43.498612: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2022-06-09 15:36:43.566517: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:04:00.0 name: Tesla K20Xm computeCapability: 3.5
coreClock: 0.732GHz coreCount: 14 deviceMemorySize: 5.57GiB deviceMemoryBandwidth: 232.46GiB/s
2022-06-09 15:36:43.567613: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 1 with properties:
pciBusID: 0000:84:00.0 name: Tesla K20Xm computeCapability: 3.5
coreClock: 0.732GHz coreCount: 14 deviceMemorySize: 5.57GiB deviceMemoryBandwidth: 232.46GiB/s
2022-06-09 15:36:43.567674: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2022-06-09 15:36:43.572849: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2022-06-09 15:36:43.572938: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2022-06-09 15:36:43.577050: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2022-06-09 15:36:43.577967: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2022-06-09 15:36:43.583037: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2022-06-09 15:36:43.585822: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2022-06-09 15:36:43.595585: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2022-06-09 15:36:43.599695: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0, 1
2022-06-09 15:36:43.600510: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-06-09 15:36:43.600668: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2022-06-09 15:36:43.775943: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties:
pciBusID: 0000:04:00.0 name: Tesla K20Xm computeCapability: 3.5
coreClock: 0.732GHz coreCount: 14 deviceMemorySize: 5.57GiB deviceMemoryBandwidth: 232.46GiB/s
2022-06-09 15:36:43.777034: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 1 with properties:
pciBusID: 0000:84:00.0 name: Tesla K20Xm computeCapability: 3.5
coreClock: 0.732GHz coreCount: 14 deviceMemorySize: 5.57GiB deviceMemoryBandwidth: 232.46GiB/s
2022-06-09 15:36:43.777094: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2022-06-09 15:36:43.777163: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
Model: "sequential"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
conv2d (Conv2D)              (None, 478, 638, 32)      896
_________________________________________________________________
max_pooling2d (MaxPooling2D) (None, 239, 319, 32)      0
_________________________________________________________________
dropout (Dropout)            (None, 239, 319, 32)      0
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 237, 317, 32)      9248
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 118, 158, 32)      0
_________________________________________________________________
dropout_1 (Dropout)          (None, 118, 158, 32)      0
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 116, 156, 32)      9248
_________________________________________________________________
max_pooling2d_2 (MaxPooling2 (None, 58, 78, 32)        0
_________________________________________________________________
dropout_2 (Dropout)          (None, 58, 78, 32)        0
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 56, 76, 32)        9248
_________________________________________________________________
max_pooling2d_3 (MaxPooling2 (None, 28, 38, 32)        0
_________________________________________________________________
dropout_3 (Dropout)          (None, 28, 38, 32)        0
_________________________________________________________________
flatten (Flatten)            (None, 34048)             0
_________________________________________________________________
dense (Dense)                (None, 64)                2179136
_________________________________________________________________
dense_1 (Dense)              (None, 4)                 260
=================================================================
Total params: 2,208,036
Trainable params: 2,208,036
Non-trainable params: 0
_________________________________________________________________
2022-06-09 15:36:43.777217: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2022-06-09 15:36:43.777269: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2022-06-09 15:36:43.777323: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2022-06-09 15:36:43.777376: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2022-06-09 15:36:43.777428: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2022-06-09 15:36:43.777481: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2022-06-09 15:36:43.781303: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0, 1
2022-06-09 15:36:43.781373: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2022-06-09 15:36:45.365248: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2022-06-09 15:36:45.365323: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 1
2022-06-09 15:36:45.365364: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N N
2022-06-09 15:36:45.365389: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 1:   N N
2022-06-09 15:36:45.370463: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 5211 MB memory) -> physical GPU (device: 0, name: Tesla K20Xm, pci bus id: 0000:04:00.0, compute capability: 3.5)
2022-06-09 15:36:45.375026: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 5211 MB memory) -> physical GPU (device: 1, name: Tesla K20Xm, pci bus id: 0000:84:00.0, compute capability: 3.5)
[34m[1mwandb[39m[22m: [33mWARNING[39m The save_model argument by default saves the model in the HDF5 format that cannot save custom objects like subclassed models and custom layers. This behavior will be deprecated in a future release in favor of the SavedModel format. Meanwhile, the HDF5 model is saved as W&B files and the SavedModel as W&B Artifacts.
Epoch 1/20
2022-06-09 15:36:47.572362: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2022-06-09 15:36:47.573238: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2599910000 Hz
2022-06-09 15:36:48.456426: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2022-06-09 15:36:49.979467: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2022-06-09 15:36:50.955982: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2022-06-09 15:36:51.025633: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output:
Relying on driver to perform ptx compilation.
Modify $PATH to customize ptxas location.
This message will be only logged once.





































58/58 [==============================] - 94s 1s/step - loss: 0.6341 - accuracy: 0.3459
Epoch 2/20







































58/58 [==============================] - 82s 1s/step - loss: 0.4197 - accuracy: 0.6753
Epoch 3/20







































58/58 [==============================] - 81s 1s/step - loss: 0.3556 - accuracy: 0.7142
Epoch 4/20







































58/58 [==============================] - 82s 1s/step - loss: 0.2835 - accuracy: 0.7679
Epoch 5/20







































58/58 [==============================] - 82s 1s/step - loss: 0.2344 - accuracy: 0.8401
Epoch 6/20







































58/58 [==============================] - 81s 1s/step - loss: 0.2302 - accuracy: 0.8192
Epoch 7/20






































58/58 [==============================] - 81s 1s/step - loss: 0.2360 - accuracy: 0.8200
Epoch 8/20







































58/58 [==============================] - 82s 1s/step - loss: 0.1918 - accuracy: 0.8492
Epoch 9/20







































58/58 [==============================] - 82s 1s/step - loss: 0.1571 - accuracy: 0.8719
Epoch 10/20







































58/58 [==============================] - 81s 1s/step - loss: 0.1625 - accuracy: 0.8693
Epoch 11/20







































58/58 [==============================] - 81s 1s/step - loss: 0.1610 - accuracy: 0.8965
Epoch 12/20







































58/58 [==============================] - 81s 1s/step - loss: 0.1611 - accuracy: 0.8935
Epoch 13/20






































58/58 [==============================] - 81s 1s/step - loss: 0.1536 - accuracy: 0.8791
Epoch 14/20







































58/58 [==============================] - 81s 1s/step - loss: 0.1703 - accuracy: 0.8759
Epoch 15/20







































58/58 [==============================] - 81s 1s/step - loss: 0.1301 - accuracy: 0.9093
Epoch 16/20






































58/58 [==============================] - 81s 1s/step - loss: 0.1375 - accuracy: 0.8978
Epoch 17/20







































58/58 [==============================] - 81s 1s/step - loss: 0.1188 - accuracy: 0.9182
Epoch 18/20






































58/58 [==============================] - 82s 1s/step - loss: 0.1151 - accuracy: 0.9174
Epoch 19/20







































58/58 [==============================] - 81s 1s/step - loss: 0.1185 - accuracy: 0.9403
Epoch 20/20







































58/58 [==============================] - 81s 1s/step - loss: 0.0913 - accuracy: 0.9474
Saving model...
Found 176 images belonging to 4 classes.

11/11 [==============================] - 3s 241ms/step - loss: 0.1106 - accuracy: 0.9148